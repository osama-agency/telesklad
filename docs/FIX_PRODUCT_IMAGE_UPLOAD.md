# Исправление ошибки загрузки изображений товаров

## Проблема
При попытке загрузить изображение товара через админку возникает ошибка:
```
Error: Ошибка при загрузке файла
    at uploadProductImage (EditProductModal.tsx:202:23)
```

## Причина
В файле окружения `.env.local` отсутствуют необходимые переменные для работы с S3 (Beget Cloud Storage). Без ключей доступа (S3_ACCESS_KEY и S3_SECRET_KEY) S3 клиент не может авторизоваться и выдает ошибку 500.

## Решение
Добавьте в файл `.env.local` следующие переменные:

```env
# S3 Configuration (Beget Cloud Storage)
S3_ENDPOINT=https://s3.ru1.storage.beget.cloud
S3_BUCKET=2c11548b454d-eldar-agency
S3_REGION=ru-1
S3_ACCESS_KEY=your_access_key_here
S3_SECRET_KEY=your_secret_key_here
```

### Где взять ключи доступа:
1. Войдите в панель управления Beget
2. Перейдите в раздел "S3-совместимое хранилище"
3. Найдите или создайте новые ключи доступа (Access Key и Secret Key)
4. Скопируйте их и вставьте в `.env.local`

### Важно:
- Не коммитьте файл `.env.local` в git
- Убедитесь, что bucket `2c11548b454d-eldar-agency` существует и доступен
- После добавления переменных перезапустите сервер разработки

## Проверка работоспособности
После добавления переменных можно проверить подключение к S3:
```bash
npm run test:s3
```

## Дополнительная информация
- Максимальный размер файла: 5MB
- Поддерживаемые форматы: JPEG, PNG, WebP
- Изображения автоматически оптимизируются до 800x800px с качеством 85%
- Все изображения конвертируются в JPEG формат

## Структура API
1. `/api/upload/image` - загрузка и оптимизация изображения
2. `/api/products/[id]/attach-image` - привязка изображения к товару
3. `/api/products/[id]/image` - получение текущего изображения товара