# –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Å–∏—Å—Ç–µ–º—ã –æ–ø–ª–∞—Ç—ã —á–µ—Ä–µ–∑ Telegram

## –û–±–∑–æ—Ä —Å–∏—Å—Ç–µ–º—ã

–°–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏ –ø–ª–∞—Ç–µ–∂–µ–π —á–µ—Ä–µ–∑ Telegram —Å–æ—Å—Ç–æ–∏—Ç –∏–∑:

1. **–¢–µ—Å—Ç–æ–≤—ã–π –±–æ—Ç** (@strattera_test_bot) - –¥–ª—è –∫–ª–∏–µ–Ω—Ç—Å–∫–∏—Ö —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –≤ development
2. **–û—Å–Ω–æ–≤–Ω–æ–π –±–æ—Ç** (@strattera_bot) - –¥–ª—è –∞–¥–º–∏–Ω—Å–∫–∏—Ö —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –∏ production
3. **WebApp** - –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –∑–∞–∫–∞–∑–æ–≤
4. **Webhook —Å–∏—Å—Ç–µ–º–∞** - –æ–±—Ä–∞–±–æ—Ç–∫–∞ callback'–æ–≤ –æ—Ç –∫–Ω–æ–ø–æ–∫

## –ù–∞—Å—Ç—Ä–æ–π–∫–∞ webhook'–æ–≤

### 1. –û—Å–Ω–æ–≤–Ω–æ–π –±–æ—Ç (–∞–¥–º–∏–Ω —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è)

```bash
curl -X POST "https://api.telegram.org/bot7612206140:AAHA6sV7VZLyUu0Ua1DAoULiFYehAkAjJK4/setWebhook" \
-H "Content-Type: application/json" \
-d '{"url": "https://strattera.ngrok.app/api/telegram/webhook", "allowed_updates": ["message", "callback_query"]}'
```

### 2. –¢–µ—Å—Ç–æ–≤—ã–π –±–æ—Ç (–∫–ª–∏–µ–Ω—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è)

```bash
curl -X POST "https://api.telegram.org/bot7754514670:AAFswWZxch4OwaLcmQp7LMzr6E3AdJ5woPg/setWebhook" \
-H "Content-Type: application/json" \
-d '{"url": "https://strattera.ngrok.app/api/telegram/webapp-webhook", "allowed_updates": ["message", "callback_query"]}'
```

## –ü—Ä–æ—Ü–µ—Å—Å –æ–ø–ª–∞—Ç—ã

### 1. –°–æ–∑–¥–∞–Ω–∏–µ –∑–∞–∫–∞–∑–∞ (WebApp ‚Üí Backend)

```
POST /api/webapp/orders
{
  "items": [{"product_id": 20, "quantity": 1}],
  "delivery_address": "...",
  "user_data": {...}
}
```

**–ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç:**
- –°–æ–∑–¥–∞–µ—Ç—Å—è –∑–∞–∫–∞–∑ —Å–æ —Å—Ç–∞—Ç—É—Å–æ–º 0 (unpaid)
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤—ã–±–∏—Ä–∞–µ—Ç—Å—è –±–∞–Ω–∫–æ–≤—Å–∫–∞—è –∫–∞—Ä—Ç–∞ (—Ä–æ—Ç–∞—Ü–∏—è)
- –î–æ–±–∞–≤–ª—è–µ—Ç—Å—è –¥–æ—Å—Ç–∞–≤–∫–∞ 500‚ÇΩ
- –í—ã–∑—ã–≤–∞–µ—Ç—Å—è `ReportService.handleOrderStatusChange()`

### 2. –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –∫–ª–∏–µ–Ω—Ç–∞ (ReportService.onUnpaid)

**–û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è —á–µ—Ä–µ–∑ —Ç–µ—Å—Ç–æ–≤—ã–π –±–æ—Ç:**
```
üéâ –í–∞—à –∑–∞–∫–∞–∑ ‚Ññ24477 –ø—Ä–∏–Ω—è—Ç.

üìå –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∑–∞–∫–∞–∑ –ø–µ—Ä–µ–¥ –æ–ø–ª–∞—Ç–æ–π:

–°–æ—Å—Ç–∞–≤ –∑–∞–∫–∞–∑–∞:
‚Ä¢ Atominex 18 mg ‚Äî 1—à—Ç. ‚Äî 5200‚ÇΩ
‚Ä¢ –î–æ—Å—Ç–∞–≤–∫–∞ ‚Äî —É—Å–ª—É–≥–∞ ‚Äî 500‚ÇΩ

–î–∞–Ω–Ω—ã–µ –¥–ª—è –¥–æ—Å—Ç–∞–≤–∫–∏:
üë§ –¢–µ—Å—Ç –¢–µ—Å—Ç–æ–≤ –ò–≤–∞–Ω–æ–≤–∏—á

üè† 199106, –≥ –°–∞–Ω–∫—Ç-–ü–µ—Ç–µ—Ä–±—É—Ä–≥, —É–ª –®–µ–≤—á–µ–Ω–∫–æ, –¥–æ–º 16, –∫–æ—Ä–ø. 2, –∫–≤. 999

üìû +7 (999) 999-99-99

–°—É–º–º–∞ –∫ –æ–ø–ª–∞—Ç–µ: 5700‚ÇΩ

‚úÖ –î–∞–ª—å–Ω–µ–π—à–∏–µ –¥–µ–π—Å—Ç–≤–∏—è:
1. –°–¥–µ–ª–∞–π—Ç–µ –ø–µ—Ä–µ–≤–æ–¥:
–í–ù–ò–ú–ê–ù–ò–ï, –û–ü–õ–ê–ß–ò–í–ê–ô–¢–ï –ò–ú–ï–ù–ù–û –ù–ê
–í–¢–ë –ë–ê–ù–ö
–ì—É–ª—å–Ω–∞—Ä–∞ –°.
+79046092695.

2. –ù–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É ¬´–Ø –æ–ø–ª–∞—Ç–∏–ª¬ª, —á—Ç–æ–±—ã –º—ã –ø—Ä–æ–≤–µ—Ä–∏–ª–∏ –ø–æ—Å—Ç—É–ø–ª–µ–Ω–∏–µ –∏ –æ—Ç–ø—Ä–∞–≤–∏–ª–∏ –≤–∞—à –∑–∞–∫–∞–∑.

‚ùóÔ∏è –ï—Å–ª–∏ –∑–∞–º–µ—Ç–∏–ª–∏ –æ—à–∏–±–∫—É ‚Äî –Ω–∞–∂–º–∏—Ç–µ ¬´–ò–∑–º–µ–Ω–∏—Ç—å –∑–∞–∫–∞–∑¬ª.
```

**–ö–Ω–æ–ø–∫–∏:**
- [–Ø –æ–ø–ª–∞—Ç–∏–ª] ‚Üí callback_data: "i_paid"
- [–ò–∑–º–µ–Ω–∏—Ç—å –∑–∞–∫–∞–∑] ‚Üí url: webapp
- [–ó–∞–¥–∞—Ç—å –≤–æ–ø—Ä–æ—Å] ‚Üí url: support

### 3. –ö–ª–∏–µ–Ω—Ç –Ω–∞–∂–∏–º–∞–µ—Ç "–Ø –æ–ø–ª–∞—Ç–∏–ª"

**Webhook:** `POST /api/telegram/webapp-webhook`
```json
{
  "callback_query": {
    "data": "i_paid",
    "from": {"id": 125861752},
    "message": {"text": "üéâ –í–∞—à –∑–∞–∫–∞–∑ ‚Ññ24477 –ø—Ä–∏–Ω—è—Ç..."}
  }
}
```

**–û–±—Ä–∞–±–æ—Ç–∫–∞:** `TelegramBotWorker.handleIPaid()`
- –ü–∞—Ä—Å–∏—Ç –Ω–æ–º–µ—Ä –∑–∞–∫–∞–∑–∞ –∏–∑ —Å–æ–æ–±—â–µ–Ω–∏—è
- –û–±–Ω–æ–≤–ª—è–µ—Ç —Å—Ç–∞—Ç—É—Å –Ω–∞ 1 (paid)
- –í—ã–∑—ã–≤–∞–µ—Ç `ReportService.handleOrderStatusChange()`
- –û—Ç–≤–µ—á–∞–µ—Ç –∫–ª–∏–µ–Ω—Ç—É: "–°–ø–∞—Å–∏–±–æ! –û–∂–∏–¥–∞–π—Ç–µ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è –æ–ø–ª–∞—Ç—ã."

### 4. –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –ø—Ä–∏ –æ–ø–ª–∞—Ç–µ (ReportService.onPaid)

**–ö–ª–∏–µ–Ω—Ç—É (—Ç–µ—Å—Ç–æ–≤—ã–π –±–æ—Ç):**
```
‚è≥ –ò–¥–µ—Ç –ø—Ä–æ–≤–µ—Ä–∫–∞ –≤–∞—à–µ–≥–æ –ø–µ—Ä–µ–≤–æ–¥–∞ –≤ –Ω–∞—à–µ–π —Å–∏—Å—Ç–µ–º–µ.

–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –æ–∂–∏–¥–∞–π—Ç–µ - –∫–∞–∫ —Ç–æ–ª—å–∫–æ –º—ã –ø–æ–¥—Ç–≤–µ—Ä–¥–∏–º –æ–ø–ª–∞—Ç—É, –≤—ã –ø–æ–ª—É—á–∏—Ç–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –∑–¥–µ—Å—å.

–ü—Ä–∏–º–µ—Ä–Ω–æ–µ –≤—Ä–µ–º—è –æ–∂–∏–¥–∞–Ω–∏—è: –æ—Ç 5 –¥–æ 30 –º–∏–Ω—É—Ç.
```

**–ê–¥–º–∏–Ω—É (–æ—Å–Ω–æ–≤–Ω–æ–π –±–æ—Ç, ID: 125861752):**
```
–ù–∞–¥–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –æ–ø–ª–∞—Ç—É –ø–æ –∑–∞–∫–∞–∑—É ‚Ññ24477

–ò—Ç–æ–≥–æ –æ—Ç–ø—Ä–∞–≤–∏–ª –∫–ª–∏–µ–Ω—Ç: 5700‚ÇΩ

–ë–∞–Ω–∫: –í–¢–ë –ë–ê–ù–ö ‚Äî –ì—É–ª—å–Ω–∞—Ä–∞ –°. ‚Äî +79046092695

üìÑ –°–æ—Å—Ç–∞–≤ –∑–∞–∫–∞–∑–∞:
‚Ä¢ Atominex 18 mg ‚Äî 1—à—Ç. ‚Äî 5200‚ÇΩ,
‚Ä¢ –î–æ—Å—Ç–∞–≤–∫–∞ ‚Äî —É—Å–ª—É–≥–∞ ‚Äî 500‚ÇΩ

üìç –ê–¥—Ä–µ—Å:
199106, –≥ –°–∞–Ω–∫—Ç-–ü–µ—Ç–µ—Ä–±—É—Ä–≥, —É–ª –®–µ–≤—á–µ–Ω–∫–æ, –¥–æ–º 16, –∫–æ—Ä–ø. 2, –∫–≤. 999

üë§ –§–ò–û:
–¢–µ—Å—Ç –¢–µ—Å—Ç–æ–≤ –ò–≤–∞–Ω–æ–≤–∏—á

üì± –¢–µ–ª–µ—Ñ–æ–Ω:
+7 (999) 999-99-99
```

**–ö–Ω–æ–ø–∫–∞ –∞–¥–º–∏–Ω—É:**
- [–û–ø–ª–∞—Ç–∞ –ø—Ä–∏—à–ª–∞] ‚Üí callback_data: "approve_payment"

### 5. –ê–¥–º–∏–Ω –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–∞–µ—Ç –æ–ø–ª–∞—Ç—É

**Webhook:** `POST /api/telegram/webhook`
```json
{
  "callback_query": {
    "data": "approve_payment", 
    "from": {"id": 125861752},
    "message": {"text": "–ù–∞–¥–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –æ–ø–ª–∞—Ç—É –ø–æ –∑–∞–∫–∞–∑—É ‚Ññ24477..."}
  }
}
```

**–û–±—Ä–∞–±–æ—Ç–∫–∞:** `TelegramBotWorker.handleApprovePayment()`
- –ü–∞—Ä—Å–∏—Ç –Ω–æ–º–µ—Ä –∑–∞–∫–∞–∑–∞
- –û–±–Ω–æ–≤–ª—è–µ—Ç —Å—Ç–∞—Ç—É—Å –Ω–∞ 2 (processing)
- –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç `paid_at: new Date()`
- –£–¥–∞–ª—è–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏–µ –∏–∑ —á–∞—Ç–∞ –∞–¥–º–∏–Ω–∞
- –í—ã–∑—ã–≤–∞–µ—Ç `ReportService.handleOrderStatusChange()`

### 6. –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –ø—Ä–∏ –æ–±—Ä–∞–±–æ—Ç–∫–µ (ReportService.onProcessing)

**–ö–ª–∏–µ–Ω—Ç—É:**
```
‚ù§Ô∏è –ë–ª–∞–≥–æ–¥–∞—Ä–∏–º –≤–∞—Å –∑–∞ –ø–æ–∫—É–ø–∫—É!

üöö –ó–∞–∫–∞–∑ ‚Ññ24477 –Ω–∞—Ö–æ–¥–∏—Ç—Å—è —É –∫—É—Ä—å–µ—Ä–∞ –∏ –≥–æ—Ç–æ–≤–∏—Ç—Å—è –∫ –æ—Ç–ø—Ä–∞–≤–∫–µ.

–ö–∞–∫ —Ç–æ–ª—å–∫–æ –ø–æ—Å—ã–ª–∫–∞ –±—É–¥–µ—Ç –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–∞, –º—ã –Ω–µ–∑–∞–º–µ–¥–ª–∏—Ç–µ–ª—å–Ω–æ –≤—ã—à–ª–µ–º –≤–∞–º —Ç—Ä–µ–∫-–Ω–æ–º–µ—Ä –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è.

–ü—Ä–æ—Ü–µ—Å—Å –æ—Ç–ø—Ä–∞–≤–∫–∏ –∑–∞–Ω–∏–º–∞–µ—Ç –æ—Ç 5 –¥–æ 48 —á–∞—Å–æ–≤.

–ë—É–¥–µ–º –ø—Ä–∏–∑–Ω–∞—Ç–µ–ª—å–Ω—ã –∑–∞ –≤–∞—à–µ —Ç–µ—Ä–ø–µ–Ω–∏–µ!
```

**–ö—É—Ä—å–µ—Ä—É (ID: courier):**
```
üëÄ –ù—É–∂–Ω–æ –æ—Ç–ø—Ä–∞–≤–∏—Ç—å –∑–∞–∫–∞–∑ ‚Ññ24477

üìÑ –°–æ—Å—Ç–∞–≤ –∑–∞–∫–∞–∑–∞:
‚Ä¢ Atominex 18 mg ‚Äî 1—à—Ç. ‚Äî 5200‚ÇΩ

üìç –ê–¥—Ä–µ—Å:
199106, –≥ –°–∞–Ω–∫—Ç-–ü–µ—Ç–µ—Ä–±—É—Ä–≥, —É–ª –®–µ–≤—á–µ–Ω–∫–æ, –¥–æ–º 16, –∫–æ—Ä–ø. 2, –∫–≤. 999

üìç –ò–Ω–¥–µ–∫—Å: 199106

üë§ –§–ò–û:
–¢–µ—Å—Ç –¢–µ—Å—Ç–æ–≤ –ò–≤–∞–Ω–æ–≤–∏—á

üì± –¢–µ–ª–µ—Ñ–æ–Ω:
+7 (999) 999-99-99

üåü‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅüåü
```

**–ö–Ω–æ–ø–∫–∞ –∫—É—Ä—å–µ—Ä—É:**
- [–ü—Ä–∏–≤—è–∑–∞—Ç—å —Ç—Ä–µ–∫] ‚Üí callback_data: "submit_tracking"

## –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤

### ReportService
**–§–∞–π–ª:** `src/lib/services/ReportService.ts`

–û—Å–Ω–æ–≤–Ω–æ–π —Å–µ—Ä–≤–∏—Å –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–π —Å—Ç–∞—Ç—É—Å–∞ –∑–∞–∫–∞–∑–∞:
- `onUnpaid()` - –æ—Ç–ø—Ä–∞–≤–∫–∞ —Ä–µ–∫–≤–∏–∑–∏—Ç–æ–≤ –∫–ª–∏–µ–Ω—Ç—É
- `onPaid()` - —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –ø—Ä–æ–≤–µ—Ä–∫–∏
- `onProcessing()` - —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–∏ –æ–ø–ª–∞—Ç—ã
- `onShipped()` - –æ—Ç–ø—Ä–∞–≤–∫–∞ —Ç—Ä–µ–∫-–Ω–æ–º–µ—Ä–∞
- `onCancelled()` - —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ–± –æ—Ç–º–µ–Ω–µ

### AdminTelegramService  
**–§–∞–π–ª:** `src/lib/services/AdminTelegramService.ts`

–°–ø–µ—Ü–∏–∞–ª—å–Ω—ã–π —Å–µ—Ä–≤–∏—Å –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ —Å–æ–æ–±—â–µ–Ω–∏–π –∞–¥–º–∏–Ω—É —á–µ—Ä–µ–∑ –æ—Å–Ω–æ–≤–Ω–æ–π –±–æ—Ç:
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç —Ç–æ–∫–µ–Ω: `7612206140:AAHA6sV7VZLyUu0Ua1DAoULiFYehAkAjJK4`
- –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –Ω–∞ ID: `125861752`
- –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç inline –∫–ª–∞–≤–∏–∞—Ç—É—Ä—ã
- –î–æ–±–∞–≤–ª—è–µ—Ç –ø—Ä–µ—Ñ–∏–∫—Å "Development" –≤ dev —Ä–µ–∂–∏–º–µ

### TelegramService
**–§–∞–π–ª:** `src/lib/services/TelegramService.ts`

–û—Å–Ω–æ–≤–Ω–æ–π —Å–µ—Ä–≤–∏—Å –¥–ª—è –∫–ª–∏–µ–Ω—Ç—Å–∫–∏—Ö —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π:
- –í development –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Ç–µ—Å—Ç–æ–≤—ã–π –±–æ—Ç
- –í production –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –æ—Å–Ω–æ–≤–Ω–æ–π –±–æ—Ç
- –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –≤—Å–µ —Ç–∏–ø—ã –∫–Ω–æ–ø–æ–∫ –∏ —Ä–∞–∑–º–µ—Ç–∫–∏

### TelegramBotWorker
**–§–∞–π–ª:** `src/lib/services/TelegramBotWorker.ts`

–û–±—Ä–∞–±–æ—Ç—á–∏–∫ webhook'–æ–≤:
- `handleIPaid()` - –æ–±—Ä–∞–±–æ—Ç–∫–∞ "–Ø –æ–ø–ª–∞—Ç–∏–ª"
- `handleApprovePayment()` - –æ–±—Ä–∞–±–æ—Ç–∫–∞ "–û–ø–ª–∞—Ç–∞ –ø—Ä–∏—à–ª–∞"
- `handleSubmitTracking()` - –∑–∞–ø—Ä–æ—Å —Ç—Ä–µ–∫-–Ω–æ–º–µ—Ä–∞
- `parseOrderNumber()` - –ø–∞—Ä—Å–∏–Ω–≥ –Ω–æ–º–µ—Ä–∞ –∑–∞–∫–∞–∑–∞ –∏–∑ —Å–æ–æ–±—â–µ–Ω–∏–π

## –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

### –ë–∞–Ω–∫–æ–≤—Å–∫–∏–µ –∫–∞—Ä—Ç—ã
–°–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤—ã–±–∏—Ä–∞–µ—Ç –∫–∞—Ä—Ç—É –∏–∑ `bank_cards` –≥–¥–µ `is_active = true`:
- –†–æ—Ç–∞—Ü–∏—è –ø–æ `updated_at` (—Å–∞–º–∞—è —Å—Ç–∞—Ä–∞—è –ø–µ—Ä–≤–∞—è)
- –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ `updated_at` –ø—Ä–∏ –≤—ã–±–æ—Ä–µ –∫–∞—Ä—Ç—ã
- –§–æ—Ä–º–∞—Ç: "–ë–∞–Ω–∫ - –§–ò–û - –¢–µ–ª–µ—Ñ–æ–Ω"

### –°—Ç–∞—Ç—É—Å—ã –∑–∞–∫–∞–∑–æ–≤
```
-1 = creating (–ø—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω—ã–π)
0 = unpaid (–æ–∂–∏–¥–∞–µ—Ç –æ–ø–ª–∞—Ç—ã)
1 = paid (–æ–ø–ª–∞—á–µ–Ω, –∂–¥–µ—Ç –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è)
2 = processing (–ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω, –≤ –æ–±—Ä–∞–±–æ—Ç–∫–µ)
3 = shipped (–æ—Ç–ø—Ä–∞–≤–ª–µ–Ω)
4 = cancelled (–æ—Ç–º–µ–Ω–µ–Ω)
5 = refunded (–≤–æ–∑–≤—Ä–∞—â–µ–Ω)
```

## –ö–æ–º–∞–Ω–¥—ã –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏

### –ü—Ä–æ–≤–µ—Ä–∫–∞ webhook'–æ–≤
```bash
# –û—Å–Ω–æ–≤–Ω–æ–π –±–æ—Ç
curl "https://api.telegram.org/bot7612206140:AAHA6sV7VZLyUu0Ua1DAoULiFYehAkAjJK4/getWebhookInfo"

# –¢–µ—Å—Ç–æ–≤—ã–π –±–æ—Ç  
curl "https://api.telegram.org/bot7754514670:AAFswWZxch4OwaLcmQp7LMzr6E3AdJ5woPg/getWebhookInfo"
```

### –£–¥–∞–ª–µ–Ω–∏–µ webhook'–æ–≤
```bash
# –û—Å–Ω–æ–≤–Ω–æ–π –±–æ—Ç
curl -X POST "https://api.telegram.org/bot7612206140:AAHA6sV7VZLyUu0Ua1DAoULiFYehAkAjJK4/deleteWebhook"

# –¢–µ—Å—Ç–æ–≤—ã–π –±–æ—Ç
curl -X POST "https://api.telegram.org/bot7754514670:AAFswWZxch4OwaLcmQp7LMzr6E3AdJ5woPg/deleteWebhook"
```

### –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã
```bash
# –ó–∞–ø—É—Å–∫ —Å–µ—Ä–≤–µ—Ä–∞
PORT=3000 npm run dev

# –ó–∞–ø—É—Å–∫ ngrok
ngrok http --domain=strattera.ngrok.app 3000

# –ù–∞—Å—Ç—Ä–æ–π–∫–∞ webhook'–æ–≤ (–≤—ã–ø–æ–ª–Ω–∏—Ç—å –∫–æ–º–∞–Ω–¥—ã –≤—ã—à–µ)

# –û—Ç–∫—Ä—ã—Ç—å WebApp
open https://strattera.ngrok.app/webapp
```

## –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –æ—Ç–ª–∞–¥–∫–∞

### –õ–æ–≥–∏ —Å–µ—Ä–≤–µ—Ä–∞
- `üìä Order X status changed: Y -> Z` - –∏–∑–º–µ–Ω–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞
- `üì§ TelegramService.call:` - –æ—Ç–ø—Ä–∞–≤–∫–∞ —á–µ—Ä–µ–∑ —Ç–µ—Å—Ç–æ–≤—ã–π –±–æ—Ç
- `üì§ AdminTelegramService.sendToAdmin:` - –æ—Ç–ø—Ä–∞–≤–∫–∞ –∞–¥–º–∏–Ω—É
- `üì≤ Callback: i_paid from X` - –æ–±—Ä–∞–±–æ—Ç–∫–∞ callback'–∞
- `‚úÖ Message sent to X, ID: Y` - —É—Å–ø–µ—à–Ω–∞—è –æ—Ç–ø—Ä–∞–≤–∫–∞

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
```sql
-- –ü–æ—Å–ª–µ–¥–Ω–∏–µ –∑–∞–∫–∞–∑—ã
SELECT id, status, total_amount, deliverycost, created_at 
FROM orders 
ORDER BY created_at DESC 
LIMIT 10;

-- –ê–∫—Ç–∏–≤–Ω—ã–µ –±–∞–Ω–∫–æ–≤—Å–∫–∏–µ –∫–∞—Ä—Ç—ã
SELECT id, name, fio, number, updated_at 
FROM bank_cards 
WHERE is_active = true 
ORDER BY updated_at ASC;
```

## –í–æ–∑–º–æ–∂–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã

### 1. Callback –Ω–µ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç—Å—è
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å webhook: `getWebhookInfo`
- –£–±–µ–¥–∏—Ç—å—Å—è —á—Ç–æ ngrok –∑–∞–ø—É—â–µ–Ω
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏ —Å–µ—Ä–≤–µ—Ä–∞ –Ω–∞ –æ—à–∏–±–∫–∏

### 2. –°–æ–æ–±—â–µ–Ω–∏—è –Ω–µ –æ—Ç–ø—Ä–∞–≤–ª—è—é—Ç—Å—è
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ç–æ–∫–µ–Ω—ã –±–æ—Ç–æ–≤ –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö
- –£–±–µ–¥–∏—Ç—å—Å—è —á—Ç–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–ª –±–æ—Ç–∞
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–∏–º–∏—Ç—ã API Telegram

### 3. –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –ø–∞—Ä—Å–∏–Ω–≥ –∑–∞–∫–∞–∑–∞
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ñ–æ—Ä–º–∞—Ç —Å–æ–æ–±—â–µ–Ω–∏—è –≤ `formatOrderItems`
- –£–±–µ–¥–∏—Ç—å—Å—è —á—Ç–æ –Ω–æ–º–µ—Ä –∑–∞–∫–∞–∑–∞ –ø—Ä–∏—Å—É—Ç—Å—Ç–≤—É–µ—Ç –≤ —Ç–µ–∫—Å—Ç–µ
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–µ–≥—É–ª—è—Ä–Ω–æ–µ –≤—ã—Ä–∞–∂–µ–Ω–∏–µ –≤ `parseOrderNumber`

### 4. –î—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ webhook –Ω–∞—Å—Ç—Ä–æ–µ–Ω —Ç–æ–ª—å–∫–æ –Ω–∞ –æ–¥–∏–Ω URL
- –£–±–µ–¥–∏—Ç—å—Å—è —á—Ç–æ –Ω–µ—Ç polling —Ä–µ–∂–∏–º–∞
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏–∫—É –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Å—Ç–∞—Ç—É—Å–∞

## –ü–ª–∞–Ω—ã —Ä–∞–∑–≤–∏—Ç–∏—è

1. **–û—á–µ—Ä–µ–¥–∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π** - –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ Redis –¥–ª—è –Ω–∞–¥–µ–∂–Ω–æ–π –¥–æ—Å—Ç–∞–≤–∫–∏
2. **–®–∞–±–ª–æ–Ω—ã —Å–æ–æ–±—â–µ–Ω–∏–π** - –≤—ã–Ω–æ—Å —Ç–µ–∫—Å—Ç–æ–≤ –≤ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö
3. **–ê–Ω–∞–ª–∏—Ç–∏–∫–∞ –ø–ª–∞—Ç–µ–∂–µ–π** - –æ—Ç—á–µ—Ç—ã –ø–æ –∫–æ–Ω–≤–µ—Ä—Å–∏–∏
4. **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ—Ç–º–µ–Ω–∞** - –æ—Ç–º–µ–Ω–∞ –Ω–µ–æ–ø–ª–∞—á–µ–Ω–Ω—ã—Ö –∑–∞–∫–∞–∑–æ–≤ —á–µ—Ä–µ–∑ 72 —á–∞—Å–∞
 