# Active Context - NEXTADMIN Project

## üéØ –¢–ï–ö–£–©–ò–ô –§–û–ö–£–° –†–ê–ó–†–ê–ë–û–¢–ö–ò

**–û—Å–Ω–æ–≤–Ω–æ–π –ø—Ä–æ–µ–∫—Ç:** `/tgapp` - –ù–æ–≤–æ–µ Telegram WebApp –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ  
**–°—Ç–∞—Ç—É—Å:** –ê–∫—Ç–∏–≤–Ω–∞—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞  
**–¶–µ–ª—å:** –°–æ–∑–¥–∞–Ω–∏–µ —Å–æ–≤—Ä–µ–º–µ–Ω–Ω–æ–≥–æ Telegram WebApp —Å –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–º —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–æ–º

## üìã –¢–ï–ö–£–©–ò–ï –ó–ê–î–ê–ß–ò

1. **–ò—Å–ø—Ä–∞–≤–ª–µ–Ω—ã –ø—Ä–æ–±–ª–µ–º—ã —Å –∏–∑–±—Ä–∞–Ω–Ω—ã–º** ‚úÖ
   - –û–ø—Ç–∏–º–∏—Å—Ç–∏—á–Ω—ã–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è UI
   - –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ –∞–Ω–∏–º–∞—Ü–∏—è –∫–Ω–æ–ø–∫–∏ —Å–µ—Ä–¥—Ü–∞
   - –î–æ–±–∞–≤–ª–µ–Ω haptic feedback

2. **–ú–∏–≥—Ä–∞—Ü–∏—è –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤** ‚úÖ
   - ProductActionButton
   - AddToCartButton 
   - SubscribeButton
   - FavoriteButton

3. **–ù–µ–∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å –æ—Ç —Å—Ç–∞—Ä–æ–≥–æ webapp** ‚úÖ
   - –í—Å–µ –∏–º–ø–æ—Ä—Ç—ã –ø–µ—Ä–µ–≤–µ–¥–µ–Ω—ã –Ω–∞ –ª–æ–∫–∞–ª—å–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã
   - –ù–µ—Ç –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π –æ—Ç /webapp/_components

## üóÇÔ∏è –°–¢–†–£–ö–¢–£–†–ê –ü–†–û–ï–ö–¢–ê

### –ê–∫—Ç–∏–≤–Ω—ã–π –ø—Ä–æ–µ–∫—Ç: `/tgapp`
- –í—Å–µ –Ω–æ–≤—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ —Ä–∞–∑—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç—Å—è –∑–¥–µ—Å—å
- –°–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–π –¥–∏–∑–∞–π–Ω —Å –∑–µ–ª–µ–Ω–æ–π —Ü–≤–µ—Ç–æ–≤–æ–π —Å—Ö–µ–º–æ–π
- –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∞–Ω–∏–º–∞—Ü–∏–∏ –∏ UX
- –ü–æ–ª–Ω–∞—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Telegram WebApp API

### –£—Å—Ç–∞—Ä–µ–≤—à–∏–π –ø—Ä–æ–µ–∫—Ç: `/webapp`
- –ë—É–¥–µ—Ç —É–¥–∞–ª–µ–Ω –≤ –±—É–¥—É—â–µ–º
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –¥–ª—è —Å—Ä–∞–≤–Ω–µ–Ω–∏—è
- –ù–ï —Ä–∞–∑—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç—Å—è

## üé® –°–¢–ò–õ–¨ –ò –ê–†–•–ò–¢–ï–ö–¢–£–†–ê

**–ö–ª—é—á–µ–≤–∞—è —Ñ—Ä–∞–∑–∞ –¥–ª—è –ø—Ä–æ–º—Ç–æ–≤:** "–°–ª–µ–¥—É–π —Å—Ç–∏–ª—é tgapp"

–≠—Ç–æ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–∏–º–µ–Ω—è–µ—Ç:
- –ó–µ–ª–µ–Ω—É—é —Ü–≤–µ—Ç–æ–≤—É—é —Å—Ö–µ–º—É (bg-green-500, bg-telegram-primary)
- –ü—Ä–∞–≤–∏–ª—å–Ω—É—é –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤
- Haptic feedback
- –û–ø—Ç–∏–º–∏—Å—Ç–∏—á–Ω—ã–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è UI
- –ò–º–ø–æ—Ä—Ç—ã —Ç–æ–ª—å–∫–æ –∏–∑ tgapp/_components

## üöÄ –°–õ–ï–î–£–Æ–©–ò–ï –≠–¢–ê–ü–´

1. **–ü–æ–ª–Ω–∞—è –º–∏–≥—Ä–∞—Ü–∏—è —Ñ—É–Ω–∫—Ü–∏–π** –∏–∑ webapp –≤ tgapp
2. **–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤** –≤ Telegram WebApp
3. **–£–¥–∞–ª–µ–Ω–∏–µ —É—Å—Ç–∞—Ä–µ–≤—à–µ–≥–æ** webapp –∫–æ–≥–¥–∞ tgapp –±—É–¥–µ—Ç –≥–æ—Ç–æ–≤
4. **–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏**

---

**–ü–æ—Å–ª–µ–¥–Ω–µ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ:** 27.12.2024  
**–°—Ç–∞—Ç—É—Å –∏–∑–±—Ä–∞–Ω–Ω–æ–≥–æ:** ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ  
**–°—Ç–∞—Ç—É—Å –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã:** ‚úÖ –ù–µ–∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å –¥–æ—Å—Ç–∏–≥–Ω—É—Ç–∞

## –¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞ (–æ–±–Ω–æ–≤–ª–µ–Ω–æ 2025-01-17)

### –ê–∫—Ç–∏–≤–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ: TgApp
- **–ü—É—Ç—å**: `/tgapp`
- **–°—Ç–∞—Ç—É—Å**: –í –∞–∫—Ç–∏–≤–Ω–æ–π —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ
- **WebApp**: `/webapp` (deprecated, –±—É–¥–µ—Ç —É–¥–∞–ª–µ–Ω)

### –ü–æ—Å–ª–µ–¥–Ω–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è

#### 1. –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∞–Ω–∏–º–∞—Ü–∏–∏ –∏–∑–±—Ä–∞–Ω–Ω–æ–≥–æ
- **–ü—Ä–æ–±–ª–µ–º–∞**: –ö–Ω–æ–ø–∫–∞ –∏–∑–±—Ä–∞–Ω–Ω–æ–≥–æ "–∑–∞–≤–∏—Å–∞–ª–∞" –ø—Ä–∏ –∫–ª–∏–∫–µ
- **–†–µ—à–µ–Ω–∏–µ**: –û–ø—Ç–∏–º–∏—Å—Ç–∏—á–Ω—ã–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è UI –≤ `FavoriteButton.tsx`
- **API**: –ò–∑–º–µ–Ω–µ–Ω –æ—Ç–≤–µ—Ç `/api/webapp/favorites` —Å 409 –Ω–∞ 200 –¥–ª—è —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö –∑–∞–ø–∏—Å–µ–π

#### 2. –ú–∏–≥—Ä–∞—Ü–∏—è –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤
- –°–∫–æ–ø–∏—Ä–æ–≤–∞–Ω—ã –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –∏–∑ webapp –≤ tgapp:
  - `SubscriptionsSheet.tsx`
  - `PhotoUploader.tsx`
  - `ProductActionButton.tsx`
  - `AddToCartButton.tsx`
  - `SubscribeButton.tsx`
- –ò—Å–ø—Ä–∞–≤–ª–µ–Ω—ã –≤—Å–µ –∏–º–ø–æ—Ä—Ç—ã –¥–ª—è –ø–æ–ª–Ω–æ–π –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ tgapp

#### 3. –°–∫—Ä—ã—Ç–∏–µ —Å–∫—Ä–æ–ª–ª–±–∞—Ä–∞
- –ì–ª–æ–±–∞–ª—å–Ω–æ–µ —Å–∫—Ä—ã—Ç–∏–µ —á–µ—Ä–µ–∑ `globals.css`
- –°–æ—Ö—Ä–∞–Ω–µ–Ω–∞ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å —Å–∫—Ä–æ–ª–ª–∞
- –§–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –ø–æ–∑–∏—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–ª—è –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏—è bounce-—ç—Ñ—Ñ–µ–∫—Ç–∞
- –û—Ç–∫–ª—é—á–µ–Ω debugMode –≤ VirtualProductCatalog

#### 4. –§–∏–ª—å—Ç—Ä –∫–∞—Ç–µ–≥–æ—Ä–∏–π –≤ –∫–∞—Ç–∞–ª–æ–≥–µ
- –°–æ–∑–¥–∞–Ω `/api/webapp/categories` –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –±—Ä–µ–Ω–¥–æ–≤
- –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã `TgButton.tsx` –∏ `TgBadge.tsx` –∞–¥–∞–ø—Ç–∏—Ä–æ–≤–∞–Ω—ã –∏–∑ Catalyst UI
- `CategoryFilter.tsx` —Å –∞–¥–∞–ø—Ç–∏–≤–Ω—ã–º –¥–∏–∑–∞–π–Ω–æ–º
- –û–±–Ω–æ–≤–ª–µ–Ω `VirtualProductCatalog.tsx` –¥–ª—è –ø–æ–¥–¥–µ—Ä–∂–∫–∏ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏

### –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏
- **–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö**: PostgreSQL –Ω–∞ Beget
- **Redis**: –õ–æ–∫–∞–ª—å–Ω—ã–π –¥–ª—è –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è
- **Telegram Bot**: @strattera_test_bot (development)
- **ngrok**: https://strattera.ngrok.app
- **–ü–æ—Ä—Ç**: 3000 (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)

### –ö–ª—é—á–µ–≤—ã–µ —Ñ–∞–π–ª—ã —Å—Ç–∏–ª–µ–π
- `/src/app/tgapp/styles/tgapp.css` - –æ—Å–Ω–æ–≤–Ω—ã–µ —Å—Ç–∏–ª–∏
- `/src/app/tgapp/styles/telegram-ui-theme.css` - —Ç–µ–º–∞ –∏ –∞–¥–∞–ø—Ç–∞—Ü–∏—è
- `/src/styles/globals.css` - –≥–ª–æ–±–∞–ª—å–Ω—ã–µ —Å—Ç–∏–ª–∏ –∏ —Å–∫—Ä—ã—Ç–∏–µ —Å–∫—Ä–æ–ª–ª–±–∞—Ä–∞

### –í–∞–∂–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã
- `TelegramAuthProvider` - –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è —á–µ—Ä–µ–∑ Telegram
- `FavoritesProvider` - —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∏–∑–±—Ä–∞–Ω–Ω—ã–º
- `VirtualProductCatalog` - –≤–∏—Ä—Ç—É–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –∫–∞—Ç–∞–ª–æ–≥ —Ç–æ–≤–∞—Ä–æ–≤
- `CategoryFilter` - —Ñ–∏–ª—å—Ç—Ä –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º/–±—Ä–µ–Ω–¥–∞–º

### API Endpoints
- `/api/webapp/auth/telegram` - –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è
- `/api/webapp/products` - —Ç–æ–≤–∞—Ä—ã (–ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç ?brand=)
- `/api/webapp/favorites` - –∏–∑–±—Ä–∞–Ω–Ω–æ–µ
- `/api/webapp/categories` - –∫–∞—Ç–µ–≥–æ—Ä–∏–∏/–±—Ä–µ–Ω–¥—ã
- `/api/webapp/cart` - –∫–æ—Ä–∑–∏–Ω–∞
- `/api/webapp/profile` - –ø—Ä–æ—Ñ–∏–ª—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

### –¢–µ–∫—É—â–∏–µ –∑–∞–¥–∞—á–∏
- ‚úÖ –ò—Å–ø—Ä–∞–≤–∏—Ç—å –∞–Ω–∏–º–∞—Ü–∏—é –∏–∑–±—Ä–∞–Ω–Ω–æ–≥–æ
- ‚úÖ –ú–∏–≥—Ä–∏—Ä–æ–≤–∞—Ç—å –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –∏–∑ webapp
- ‚úÖ –°–∫—Ä—ã—Ç—å —Å–∫—Ä–æ–ª–ª–±–∞—Ä –≤ Telegram WebApp
- ‚úÖ –î–æ–±–∞–≤–∏—Ç—å —Ñ–∏–ª—å—Ç—Ä –∫–∞—Ç–µ–≥–æ—Ä–∏–π
- ‚è≥ –ü–æ–ª–Ω–æ—Å—Ç—å—é —É–¥–∞–ª–∏—Ç—å webapp –ø–æ—Å–ª–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

### 5. –£–Ω–∏—Ñ–∏–∫–∞—Ü–∏—è —Ñ–æ–Ω–æ–≤ –≤ —Ç–µ–º–Ω–æ–π —Ç–µ–º–µ (2025-01-17)
- **–ü—Ä–æ–±–ª–µ–º–∞**: –†–∞–∑–Ω—ã–µ —Ñ–æ–Ω—ã –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–∞—Ö –∏ –≤ –º–æ–¥–∞–ª–∫–∞—Ö –≤ —Ç–µ–º–Ω–æ–π —Ç–µ–º–µ
- **–†–µ—à–µ–Ω–∏–µ**: –°–æ–∑–¥–∞–Ω–∞ —Å–∏—Å—Ç–µ–º–∞ —É–Ω–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö —Å—Ç–∏–ª–µ–π
- **–§–∞–π–ª—ã**:
  - `telegram-ui-theme.css` - —É–Ω–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Å—Ç–∏–ª–∏ –¥–ª—è —Ç–µ–º–Ω–æ–π —Ç–µ–º—ã
  - `tgapp.css` - –æ–±–Ω–æ–≤–ª–µ–Ω—ã –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è transparent —Ñ–æ–Ω–∞
- **–ü—Ä–∏–Ω—Ü–∏–ø**: 
  - –°—Ç—Ä–∞–Ω–∏—Ü—ã: –≥—Ä–∞–¥–∏–µ–Ω—Ç–Ω—ã–π —Ñ–æ–Ω
  - –ú–æ–¥–∞–ª–∫–∏: —Ç–∞–∫–æ–π –∂–µ –≥—Ä–∞–¥–∏–µ–Ω—Ç–Ω—ã–π —Ñ–æ–Ω
  - –ö–∞—Ä—Ç–æ—á–∫–∏: –≤—Ç–æ—Ä–∏—á–Ω—ã–π —Ü–≤–µ—Ç (#161b22)
- **–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è**: `memory-bank/NEXTADMIN/tgapp-dark-theme-unification.md`