# üîß –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è: –ö—É—Ä—Å –≤–∞–ª—é—Ç –∏ –¥–æ—Å—Ç–∞–≤–∫–∞

## ‚ùå –ß—Ç–æ –±—ã–ª–æ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ:

### 1. **–î–æ—Å—Ç–∞–≤–∫–∞ –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –∑–∞–∫—É–ø–∫–∏**
- ‚ùå –î–æ—Å—Ç–∞–≤–∫–∞ —É—á–∏—Ç—ã–≤–∞–ª–∞—Å—å –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –∑–∞–∫—É–ø–∫–∏ (350‚ÇΩ)
- ‚ùå –î–æ–±–∞–≤–ª—è–ª–∞—Å—å –∫ –∏—Ç–æ–≥–æ–≤–æ–π —Å—É–º–º–µ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏

### 2. **–ö—É—Ä—Å –ª–∏—Ä—ã –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏**
- ‚ùå –ö—É—Ä—Å –ª–∏—Ä—ã —Å–æ—Ö—Ä–∞–Ω—è–ª—Å—è –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –∑–∞–∫—É–ø–∫–∏
- ‚ùå –§–∏–∫—Å–∏—Ä–æ–≤–∞–ª—Å—è –≤ –º–æ–º–µ–Ω—Ç —Å–æ–∑–¥–∞–Ω–∏—è, –∞ –Ω–µ –æ–ø–ª–∞—Ç—ã

## ‚úÖ –ß—Ç–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ:

### 1. **–î–æ—Å—Ç–∞–≤–∫–∞ —Ç–æ–ª—å–∫–æ –ø—Ä–∏ –æ–ø—Ä–∏—Ö–æ–¥–æ–≤–∞–Ω–∏–∏**
```typescript
// ‚ùå –ë—ã–ª–æ: –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –∑–∞–∫—É–ø–∫–∏
const totalWithDelivery = totalRUB + deliveryCost; // 350‚ÇΩ

// ‚úÖ –°—Ç–∞–ª–æ: —Ç–æ–ª—å–∫–æ –ø—Ä–∏ –æ–ø—Ä–∏—Ö–æ–¥–æ–≤–∞–Ω–∏–∏
const receiveData = {
  deliveryDays: 18,
  additionalExpenses: 1500, // –§–∞–∫—Ç–∏—á–µ—Å–∫–∞—è —Å—Ç–æ–∏–º–æ—Å—Ç—å –¥–æ—Å—Ç–∞–≤–∫–∏
  notes: "–¢–æ–≤–∞—Ä –ø–æ–ª—É—á–µ–Ω"
};
```

### 2. **–ö—É—Ä—Å –ª–∏—Ä—ã —Ñ–∏–∫—Å–∏—Ä—É–µ—Ç—Å—è –ø—Ä–∏ –æ–ø–ª–∞—Ç–µ**
```typescript
// ‚ùå –ë—ã–ª–æ: –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏
const purchase = await createPurchase({
  exchangeRate: currentRate // —Å–æ—Ö—Ä–∞–Ω—è–ª—Å—è —Å—Ä–∞–∑—É
});

// ‚úÖ –°—Ç–∞–ª–æ: –ø—Ä–∏ –æ–ø–ª–∞—Ç–µ
if (status === 'paid' && purchase.status !== 'paid') {
  // –ü–æ–ª—É—á–∞–µ–º –∏ —Å–æ—Ö—Ä–∞–Ω—è–µ–º —Ç–µ–∫—É—â–∏–π –∫—É—Ä—Å –ª–∏—Ä—ã
  const latestRate = await getLatestTRYRate();
  exchangeRate = latestRate; // —Ñ–∏–∫—Å–∏—Ä—É–µ—Ç—Å—è –Ω–∞–≤—Å–µ–≥–¥–∞
}
```

## üìÇ –ò–∑–º–µ–Ω–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã:

### 1. `PurchaseCartModal.tsx`
- ‚úÖ –£–±—Ä–∞–Ω–∞ –¥–æ—Å—Ç–∞–≤–∫–∞ –∏–∑ —Ä–∞—Å—á–µ—Ç–æ–≤ –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏
- ‚úÖ –¶–µ–Ω–∞ –≤ –ª–∏—Ä–∞—Ö —Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è –ø–æ —Ç–µ–∫—É—â–µ–º—É –∫—É—Ä—Å—É
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–∞ –∑–∞–º–µ—Ç–∫–∞ "–î–æ—Å—Ç–∞–≤–∫–∞ —É–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è –ø—Ä–∏ –æ–ø—Ä–∏—Ö–æ–¥–æ–≤–∞–Ω–∏–∏"

### 2. `src/app/api/purchases/create/route.ts`
- ‚úÖ –£–±—Ä–∞–Ω–æ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∫—É—Ä—Å–∞ –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –∑–∞–∫—É–ø–∫–∏
- ‚úÖ –£–ø—Ä–æ—â–µ–Ω –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å —Ç–µ–∫—É—â–µ–π —Å—Ö–µ–º–æ–π –ë–î

### 3. `src/app/api/purchases/[id]/status/route.ts`
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–æ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∫—É—Ä—Å–∞ –ø—Ä–∏ –ø–µ—Ä–µ—Ö–æ–¥–µ –≤ —Å—Ç–∞—Ç—É—Å "paid"
- ‚úÖ –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ —Ñ–∏–∫—Å–∞—Ü–∏–∏ –∫—É—Ä—Å–∞

### 4. `ReceivePurchaseModal.tsx`
- ‚úÖ –ü–æ–ª–µ "–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ä–∞—Å—Ö–æ–¥—ã –Ω–∞ –ª–æ–≥–∏—Å—Ç–∏–∫—É" 
- ‚úÖ –ß–µ—Ç–∫–æ–µ —É–∫–∞–∑–∞–Ω–∏–µ —á—Ç–æ –¥–æ—Å—Ç–∞–≤–∫–∞ —É—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –∑–¥–µ—Å—å

## üîÑ –ù–æ–≤—ã–π –ø—Ä–æ—Ü–µ—Å—Å:

### –≠—Ç–∞–ø 1: –°–æ–∑–¥–∞–Ω–∏–µ –∑–∞–∫—É–ø–∫–∏ (draft)
```typescript
const purchase = await createPurchase({
  items: [...],
  supplier: "–ü–æ—Å—Ç–∞–≤—â–∏–∫ –¢—É—Ä—Ü–∏—è",
  // –ë–ï–ó –∫—É—Ä—Å–∞ –ª–∏—Ä—ã
  // –ë–ï–ó –¥–æ—Å—Ç–∞–≤–∫–∏
});
// –¶–µ–Ω–∞ –≤ –ª–∏—Ä–∞—Ö –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è –ø–æ —Ç–µ–∫—É—â–µ–º—É –∫—É—Ä—Å—É
```

### –≠—Ç–∞–ø 2: –û–ø–ª–∞—Ç–∞ (paid)
```typescript
await updatePurchaseStatus(purchase.id, 'paid');
// üí∞ –ö—É—Ä—Å –ª–∏—Ä—ã –§–ò–ö–°–ò–†–£–ï–¢–°–Ø –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
// –õ–æ–≥–∏—Ä—É–µ—Ç—Å—è: "–ó–∞–∫—É–ø–∫–∞ #123 –æ–ø–ª–∞—á–µ–Ω–∞. –ö—É—Ä—Å –ª–∏—Ä—ã –∑–∞—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω: 2.0167"
```

### –≠—Ç–∞–ø 3: –û—Ç–ø—Ä–∞–≤–∫–∞ (sent)
```typescript
await updatePurchaseStatus(purchase.id, 'sent');
// üìÖ –°–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –¥–∞—Ç–∞ –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏—è –∑–∞–∫–∞–∑–∞
```

### –≠—Ç–∞–ø 4: –í –ø—É—Ç–∏ (in_transit)
- ‚è±Ô∏è –û—Ç—Å–ª–µ–∂–∏–≤–∞–µ—Ç—Å—è –≤—Ä–µ–º—è –≤ –ø—É—Ç–∏
- üé® –¶–≤–µ—Ç–æ–≤–∞—è –∏–Ω–¥–∏–∫–∞—Ü–∏—è —Å—Ç–∞—Ç—É—Å–∞ –¥–æ—Å—Ç–∞–≤–∫–∏

### –≠—Ç–∞–ø 5: –û–ø—Ä–∏—Ö–æ–¥–æ–≤–∞–Ω–∏–µ (received)
```typescript
const receiveData = {
  deliveryDays: 15, // –§–∞–∫—Ç–∏—á–µ—Å–∫–æ–µ –≤—Ä–µ–º—è
  additionalExpenses: 1200, // üöö –î–û–°–¢–ê–í–ö–ê —É—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è –ó–î–ï–°–¨
  notes: "–í—Å–µ —Ç–æ–≤–∞—Ä—ã –ø–æ–ª—É—á–µ–Ω—ã"
};
await receivePurchase(purchase.id, receiveData);
```

## üéØ –†–µ–∑—É–ª—å—Ç–∞—Ç:

### ‚úÖ –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ –Ω–æ–≤–æ–≥–æ –ø–æ–¥—Ö–æ–¥–∞:
1. **–¢–æ—á–Ω–∞—è —Ñ–∏–∫—Å–∞—Ü–∏—è –∫—É—Ä—Å–∞** - –∫—É—Ä—Å —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –ø—Ä–∏ –æ–ø–ª–∞—Ç–µ, –∫–æ–≥–¥–∞ —ç—Ç–æ –∞–∫—Ç—É–∞–ª—å–Ω–æ
2. **–†–µ–∞–ª—å–Ω–∞—è —Å—Ç–æ–∏–º–æ—Å—Ç—å –¥–æ—Å—Ç–∞–≤–∫–∏** - —É–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è —Ñ–∞–∫—Ç–∏—á–µ—Å–∫–∞—è —Å—Ç–æ–∏–º–æ—Å—Ç—å –ø—Ä–∏ –ø–æ–ª—É—á–µ–Ω–∏–∏
3. **–ß–µ—Å—Ç–Ω–∞—è –æ—Ç—á–µ—Ç–Ω–æ—Å—Ç—å** - –∑–∞–∫—É–ø–∫–∞ –Ω–µ –∑–∞–≤—ã—à–∞–µ—Ç—Å—è –Ω–∞ –≥–∏–ø–æ—Ç–µ—Ç–∏—á–µ—Å–∫—É—é –¥–æ—Å—Ç–∞–≤–∫—É
4. **–ì–∏–±–∫–æ—Å—Ç—å** - –¥–æ—Å—Ç–∞–≤–∫–∞ –º–æ–∂–µ—Ç –≤–∞—Ä—å–∏—Ä–æ–≤–∞—Ç—å—Å—è –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –æ–±—ä–µ–º–∞ –∏ —Å–ø–æ—Å–æ–±–∞

### üìä –î–ª—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∏:
- –ë–æ–ª–µ–µ —Ç–æ—á–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –æ —Ä–µ–∞–ª—å–Ω–æ–π —Å—Ç–æ–∏–º–æ—Å—Ç–∏ –∑–∞–∫—É–ø–æ–∫
- –û—Ç–¥–µ–ª—å–Ω—ã–π —É—á–µ—Ç —Ä–∞—Å—Ö–æ–¥–æ–≤ –Ω–∞ –ª–æ–≥–∏—Å—Ç–∏–∫—É
- –ö–æ—Ä—Ä–µ–∫—Ç–Ω—ã–µ —Ä–∞—Å—á–µ—Ç—ã —Ä–µ–Ω—Ç–∞–±–µ–ª—å–Ω–æ—Å—Ç–∏

## üöÄ –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏:

1. **–ü—Ä–∏–º–µ–Ω–∏—Ç—å –º–∏–≥—Ä–∞—Ü–∏—é**: `npx prisma migrate dev`
2. **–û–±–Ω–æ–≤–∏—Ç—å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –∑–∞–∫—É–ø–∫–∏** (–ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏)
3. **–ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –Ω–æ–≤—ã–π –ø—Ä–æ—Ü–µ—Å—Å** —Å–æ–∑–¥–∞–Ω–∏—è –∏ –æ–ø—Ä–∏—Ö–æ–¥–æ–≤–∞–Ω–∏—è
4. **–û–±—É—á–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π** –Ω–æ–≤–æ–π –ª–æ–≥–∏–∫–µ

---

**–î–∞—Ç–∞ –∏–∑–º–µ–Ω–µ–Ω–∏–π**: –ò—é–Ω—å 2025  
**–ê–≤—Ç–æ—Ä**: AI Assistant  
**–°—Ç–∞—Ç—É—Å**: ‚úÖ –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ 