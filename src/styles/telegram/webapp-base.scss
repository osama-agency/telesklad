// ========================================
// TELEGRAM WEBAPP BASE - .tg-webapp- namespace
// ========================================

// Base webapp container with Telegram integration
.tg-webapp-container {
  font-family: var(--font-family-primary);
  font-weight: var(--font-weight-normal);
  font-size: var(--font-size-sm);
  line-height: 1.5;
  color: var(--tg-text-color, var(--color-text));
  background: var(--tg-bg-color, var(--color-bg));
  
  width: 100%;
  max-width: 100%;
  min-height: 100vh;
  overflow-x: hidden;
  
  // Use new spacing system
  padding: var(--space-6) var(--space-4);
  
  // Safe Area Support for Telegram WebApp
  @include safe-area-padding;
  
  // Typography using new variables
  h1 {
    font-weight: var(--font-weight-bold);
    font-size: var(--font-size-2xl);
    line-height: 1.2;
    margin: 0;
    color: var(--tg-text-color, var(--color-text));
  }

  h2 {
    font-weight: var(--font-weight-bold);
    font-size: var(--font-size-xl);
    line-height: 1.3;
    margin: 0;
    color: var(--tg-text-color, var(--color-text));
  }

  h3 {
    font-weight: var(--font-weight-semibold);
    font-size: var(--font-size-base);
    line-height: 1.4;
    margin: 0;
    color: var(--tg-text-color, var(--color-text));
  }
}

// Telegram WebApp specific spacing fixes (integrated from telegram-webapp-spacing-fixes.scss)
.tg-webapp-catalog-page {
  .tg-webapp-container-adaptive {
    padding-top: 0 !important;
  }
  
  .tg-webapp-category-filter {
    margin-top: 0 !important;
    margin-bottom: var(--space-2) !important;
    padding: var(--space-1) 0 !important;
  }
  
  .tg-webapp-header-search {
    .algolia-search-box .search-input {
      @include flex-center;
      min-height: 18px !important;
    }
  }
  
  .tg-webapp-header {
    border-bottom: none !important;
    
    &.scrolled {
      box-shadow: 0 1px 3px rgba(0, 0, 0, 0.02) !important;
    }
  }
  
  .tg-webapp-product-catalog {
    margin-top: 0 !important;
    padding-top: 0 !important;
    
    .tg-webapp-category-filter + * {
      margin-top: var(--space-2) !important;
    }
  }
}

// Telegram Cart specific spacing fixes (integrated from telegram-cart-spacing-fix.scss)
.tg-webapp-cart-page {
  .tg-webapp-cart-container {
    @include stack(var(--space-4));
    padding: var(--space-4);
  }
  
  .tg-webapp-cart-header {
    @include flex-between;
    margin-bottom: var(--space-6);
    
    .tg-webapp-cart-title {
      font-size: var(--font-size-xl);
      font-weight: var(--font-weight-bold);
      color: var(--tg-text-color, var(--color-text));
      margin: 0;
    }
    
    .tg-webapp-cart-count {
      font-size: var(--font-size-sm);
      color: var(--tg-text-secondary, var(--color-text-light));
    }
  }
  
  .tg-webapp-cart-items {
    @include stack(var(--space-3));
  }
  
  .tg-webapp-cart-item {
    @include card;
    padding: var(--space-4);
    
    .tg-webapp-cart-item-content {
      @include inline-stack(var(--space-3));
    }
    
    .tg-webapp-cart-item-image {
      width: 60px;
      height: 60px;
      border-radius: 8px;
      object-fit: cover;
      flex-shrink: 0;
    }
    
    .tg-webapp-cart-item-details {
      @include stack(var(--space-1));
      flex: 1;
      min-width: 0;
    }
    
    .tg-webapp-cart-item-title {
      font-size: var(--font-size-sm);
      font-weight: var(--font-weight-medium);
      color: var(--tg-text-color, var(--color-text));
      @include truncate;
      margin: 0;
    }
    
    .tg-webapp-cart-item-price {
      font-size: var(--font-size-base);
      font-weight: var(--font-weight-semibold);
      color: var(--tg-primary, var(--color-primary));
    }
    
    .tg-webapp-cart-item-controls {
      @include inline-stack(var(--space-2));
      flex-shrink: 0;
    }
  }
  
  .tg-webapp-cart-summary {
    @include card;
    padding: var(--space-4);
    margin-top: var(--space-6);
    
    .tg-webapp-cart-total {
      @include flex-between;
      margin-bottom: var(--space-4);
      
      .tg-webapp-cart-total-label {
        font-size: var(--font-size-base);
        font-weight: var(--font-weight-medium);
        color: var(--tg-text-color, var(--color-text));
      }
      
      .tg-webapp-cart-total-amount {
        font-size: var(--font-size-lg);
        font-weight: var(--font-weight-bold);
        color: var(--tg-primary, var(--color-primary));
      }
    }
  }
}

// Telegram WebApp specific responsive adjustments
@include mobile {
  .tg-webapp-catalog-page {
    .tg-webapp-category-filter {
      margin-top: var(--space-1) !important;
      margin-bottom: var(--space-1) !important;
      padding: var(--space-1) 0 !important;
    }
    
    .tg-webapp-header-search {
      .algolia-search-box .search-input {
        padding-top: var(--space-1) !important;
        padding-bottom: var(--space-1) !important;
        height: 32px !important;
      }
    }
  }
  
  .tg-webapp-cart-page {
    .tg-webapp-cart-container {
      padding: var(--space-3);
    }
    
    .tg-webapp-cart-item {
      padding: var(--space-3);
      
      .tg-webapp-cart-item-image {
        width: 50px;
        height: 50px;
      }
    }
  }
}

@include desktop {
  .tg-webapp-catalog-page {
    .tg-webapp-category-filter {
      margin-top: var(--space-3) !important;
      margin-bottom: var(--space-3) !important;
    }
  }
  
  .tg-webapp-cart-page {
    max-width: 600px;
    margin: 0 auto;
  }
}

// Telegram WebApp animations
.tg-webapp-catalog-page {
  .tg-webapp-header + main .tg-webapp-category-filter {
    animation: tgWebappSlideInFromTop 0.3s ease-out;
  }
}

@keyframes tgWebappSlideInFromTop {
  from {
    opacity: 0;
    transform: translateY(-10px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

// Hide scrollbar on catalog page (from spacing fixes)
.tg-webapp-catalog-page,
.tg-webapp-catalog-page * {
  @include hide-scrollbar;
}

// Telegram WebApp main button integration
.tg-webapp-main-button {
  @include button-primary;
  @include no-focus;
  
  position: fixed;
  bottom: 0;
  left: 0;
  right: 0;
  width: 100%;
  padding: var(--space-4) var(--space-6);
  font-size: var(--font-size-base);
  font-weight: var(--font-weight-semibold);
  background: var(--tg-button-color, var(--color-primary));
  color: var(--tg-button-text-color, var(--color-bg-white));
  border-radius: 0;
  z-index: var(--z-fixed);
  
  // Safe area support
  @include safe-area-bottom;
  
  &:hover {
    background: var(--color-primary-dark);
  }
  
  &:disabled {
    background: var(--color-text-light);
    cursor: not-allowed;
  }
  
  // Show/hide animation
  &.tg-webapp-main-button-hidden {
    transform: translateY(100%);
    opacity: 0;
  }
  
  &.tg-webapp-main-button-visible {
    transform: translateY(0);
    opacity: 1;
  }
}

// Telegram WebApp back button (handled by SDK)
.tg-webapp-back-button {
  // This is handled by Telegram SDK, no styles needed
  display: none;
}

// Telegram WebApp viewport meta integration
.tg-webapp-viewport {
  // Ensure proper viewport behavior
  touch-action: manipulation;
  -webkit-text-size-adjust: 100%;
  -webkit-touch-callout: none;
  -webkit-user-select: none;
  user-select: none;
}

// Telegram WebApp haptic feedback classes
.tg-webapp-haptic-light {
  // Light haptic feedback trigger
}

.tg-webapp-haptic-medium {
  // Medium haptic feedback trigger  
}

.tg-webapp-haptic-heavy {
  // Heavy haptic feedback trigger
}

// Telegram WebApp closing confirmation
.tg-webapp-closing-confirmation {
  // This is handled by Telegram SDK
}

// Integration with legacy styles (temporary)
.webapp-container.tg-webapp-enabled {
  @extend .tg-webapp-container;
}

.webapp-container.catalog-page.tg-webapp-enabled {
  @extend .tg-webapp-catalog-page;
}

.webapp-container.cart-page.tg-webapp-enabled {
  @extend .tg-webapp-cart-page;
} 